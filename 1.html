<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Geral - Foco na Coluna Central (Ajuste Final)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      /* Estilos de Fundo para o Tema Escuro */
      body {
        background-color: #0f172a;
        margin: 0;
      }

      /* Estilos para o Gráfico de Donut (Mantidos) */
      .donut-chart-modern {
        /* Conic Gradient para o Anel (Cores Modernas) */
        background: conic-gradient(
          #a78bfa 0% 40%,
          /* Roxo (40%) */ #38bdf8 40% 70%,
          /* Ciano Claro (30%) */ #f472b6 70% 90%,
          /* Pink (20%) */ #facc15 90% 100% /* Amarelo (10%) */
        );
        border-radius: 50%;
        height: 140px;
        width: 140px;
        position: relative;
        /* Sombra/Glow para um efeito moderno */
        box-shadow: 0 0 15px rgba(167, 139, 250, 0.2);
        /* Transição para o efeito de hover */
        transition: transform 0.3s ease-in-out, box-shadow 0.3s;
        cursor: pointer;
      }
      .donut-chart-modern:hover {
        transform: scale(1.05); /* Efeito de Zoom */
        box-shadow: 0 0 20px rgba(167, 139, 250, 0.6);
      }
      /* Cria o 'buraco' central para o efeito Donut e contém o texto */
      .donut-chart-hole {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        height: 80px;
        width: 80px;
        background-color: #1e293b; /* Cor do fundo do painel (Slate 800) */
        border-radius: 50%;
        border: 3px solid #334155; /* Borda sutil */
        /* Centraliza o texto interno */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      /* --- ESTILOS DA COLUNA DIREITA (NOVOS) --- */
      .metric-value { font-size: 1.1rem; font-weight: bold; }
      
      /* Estilos para Badges de Ranking (Personalizados) */
      .rank-badge {
          font-size: 0.7rem; font-weight: bold; padding: 2px 6px; 
          border-radius: 9999px; display: inline-flex; align-items: center; line-height: 1;
          background-color: #374151; color: #E5E7EB; 
      }
      .rank-challenger { background-color: #FFC107; color: #1E293B; } 
      .rank-grandmaster { background-color: #E91E63; color: #E5E7EB; }
      .rank-master { background-color: #9C27B0; color: #E5E7EB; }
      .rank-diamond { background-color: #00BCD4; color: #1E293B; } 
      .rank-emerald { background-color: #4CAF50; color: #1E293B; }
      .rank-platinum { background-color: #81D4FA; color: #1E293B; } 
      .rank-gold { background-color: #FACC15; color: #1E293B; } 
      .rank-silver { background-color: #BDBDBD; color: #1E293B; }
      .rank-bronze { background-color: #8D6E63; color: #E5E7EB; }
      .rank-iron { background-color: #424242; color: #E5E7EB; }
      
      /* Estilo para a informação secundária (Nível e País) */
      .student-meta {
          font-size: 0.7rem;
          color: #94A3B8; /* Slate 400 */
          line-height: 1.2;
      }
      /* Estilo para o Nível de Fluência */
      .level-badge {
          font-size: 0.6rem;
          font-weight: bold;
          padding: 1px 4px;
          border-radius: 4px;
          background-color: #475569; /* Slate 600 */
          color: #E2E8F0; /* Slate 200 */
          margin-left: 4px;
          white-space: nowrap;
      }
      /* Estilo para o item da lista ser clicável e responsivo */
      .list-item-clickable {
          padding: 0.5rem; 
          border-radius: 0.375rem;
          transition: background-color 0.2s;
          cursor: pointer;
          display: block; 
      }
      .list-item-clickable:hover {
          background-color: #334155; 
      }
    </style>
  </head>
  <body class="p-0">
    <header
      class="w-full flex justify-center bg-slate-900 border-b border-slate-700 p-4"
    >
      <div class="w-full text-center text-xl text-indigo-400 font-bold">
        <div
          class="max-w-7xl w-full flex flex-col md:flex-row justify-between items-center text-white p-3 sm:p-4 bg-slate-900 border-b border-slate-700 shadow-lg"
        >
          <div class="flex items-center mb-3 md:mb-0">
            <i
              data-lucide="graduation-cap"
              class="w-8 h-8 mr-3 text-indigo-400"
            ></i>
            <div class="flex flex-col items-start">
              <span class="text-xl font-bold text-white leading-tight"
                >Plataforma Tutor</span
              >
              <span
                class="text-sm text-slate-300 font-medium mt-0.5 flex items-center"
              >
                <i data-lucide="mail" class="w-4 h-4 mr-1 text-slate-400"></i>
                usuario.logado@gmail.com
              </span>
            </div>
          </div>

          <div
            class="flex flex-wrap items-center justify-center gap-3 text-sm font-medium"
          >
            <div
              class="bg-green-900/40 p-2 rounded-lg border border-green-600 flex items-center min-w-[100px] justify-between"
            >
              <div class="flex flex-col">
                <span class="text-slate-400 text-xs">Dólar Atual</span>
                <span class="metric-value text-green-300" id="cotacao-dolar"
                  >R$ 5,00</span
                >
              </div>
              <button
                id="btn-refresh"
                class="text-green-400 hover:text-green-300 ml-2 transition duration-150 p-1 rounded-full"
                title="Atualizar cotação agora"
              >
                <i
                  id="icon-refresh"
                  data-lucide="rotate-cw"
                  class="w-4 h-4"
                ></i>
              </button>
            </div>

            <div
              class="bg-red-900/40 p-2 rounded-lg border border-red-600 min-w-[120px]"
            >
              <span class="text-slate-400 text-xs block">Taxa (1,5%)</span>
              <span class="metric-value text-red-300" id="desconto-usd"
                >US$ 0,15</span
              >
            </div>

            <div
              class="bg-indigo-900/40 p-2 rounded-lg border border-indigo-600 min-w-[120px]"
            >
              <span class="text-slate-400 text-xs block"
                >Valor Líquido (USD)</span
              >
              <span class="metric-value text-indigo-300" id="total-bruto-usd"
                >US$ 9,85</span
              >
            </div>

            <div
              class="bg-yellow-900/40 p-2 rounded-lg border border-yellow-600 min-w-[120px]"
            >
              <span class="text-slate-400 text-xs block">Total em Reais</span>
              <span class="metric-value text-yellow-300" id="total-liquido-brl"
                >R$ 49,25</span
              >
            </div>

            <button
              class="p-2 sm:p-3 rounded-full bg-slate-700 hover:bg-slate-600 transition duration-150 ml-2"
            >
              <i data-lucide="menu" class="w-6 h-6 text-white"></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <main class="w-full p-4 sm:p-8">
      <div class="flex flex-col md:flex-row gap-6">
        <section
          id="coluna-esquerda"
          class="w-full md:w-1/5 bg-slate-800 p-4 rounded-lg border border-slate-700 min-h-[500px] text-white"
        >
          <h3
            class="text-lg font-bold text-indigo-400 border-b border-indigo-600 pb-2 mb-4 flex items-center"
          >
            <i data-lucide="users" class="w-5 h-5 mr-2"></i> Lista de Alunos
          </h3>
          <p class="text-sm text-slate-400">
            *** COLAR ALUNOS AQUI (ESQUERDA) ***
          </p>
        </section>

        <section
          id="coluna-centro"
          class="w-full md:w-3/5 bg-slate-800 p-4 rounded-lg border border-slate-700 min-h-[500px] text-white"
        >
          <h3
            class="text-xl font-bold text-yellow-400 border-b border-yellow-600 pb-2 mb-4 flex items-center"
          >
            <i data-lucide="bar-chart-3" class="w-6 h-6 mr-2"></i> Estatísticas
            Globais
          </h3>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
            <div
              class="p-4 rounded-lg bg-slate-700/50 border border-slate-600 shadow-md"
            >
              <h4 class="text-center text-base font-semibold mb-4 text-white">
                Motivação dos Alunos
              </h4>

              <div class="flex items-center justify-center space-x-6">
                <div
                  class="donut-chart-modern"
                  style="
                    background: conic-gradient(
                      #facc15 0% 40%,
                      #a78bfa 40% 70%,
                      #38bdf8 70% 90%,
                      #f472b6 90% 100%
                    );
                  "
                >
                  <div class="donut-chart-hole">
                    <span class="text-xl font-bold text-yellow-300">100%</span>
                    <span class="text-xs text-slate-400 leading-none"
                      >Total</span
                    >
                  </div>
                </div>

                <div
                  class="text-xs space-y-2 text-left min-w-[120px] font-medium"
                >
                  <p class="flex items-center text-yellow-300">
                    <span
                      class="w-3 h-3 bg-yellow-400 rounded-full mr-2"
                    ></span>
                    Carreira (<span class="font-bold ml-1">40%</span>)
                  </p>
                  <p class="flex items-center text-purple-300">
                    <span
                      class="w-3 h-3 bg-purple-400 rounded-full mr-2"
                    ></span>
                    Viagem (<span class="font-bold ml-1">30%</span>)
                  </p>
                  <p class="flex items-center text-cyan-300">
                    <span class="w-3 h-3 bg-cyan-400 rounded-full mr-2"></span>
                    Fluência (<span class="font-bold ml-1">20%</span>)
                  </p>
                  <p class="flex items-center text-pink-300">
                    <span class="w-3 h-3 bg-pink-400 rounded-full mr-2"></span>
                    Outros (<span class="font-bold ml-1">10%</span>)
                  </p>
                </div>
              </div>
            </div>

            <div
              class="p-4 rounded-lg bg-slate-700/50 border border-slate-600 shadow-md"
            >
              <h4 class="text-center text-base font-semibold mb-4 text-white">
                Países / Idiomas
              </h4>

              <div class="flex items-center justify-center space-x-6">
                <div
                  class="donut-chart-modern"
                  style="
                    background: conic-gradient(
                      #34d399 0% 45%,
                      #f472b6 45% 70%,
                      #6366f1 70% 85%,
                      #facc15 85% 100%
                    );
                  "
                >
                  <div class="donut-chart-hole">
                    <span class="text-xl font-bold text-green-300">100%</span>
                    <span class="text-xs text-slate-400 leading-none"
                      >Total</span
                    >
                  </div>
                </div>

                <div
                  class="text-xs space-y-2 text-left min-w-[120px] font-medium"
                >
                  <p class="flex items-center text-green-300">
                    <span class="w-3 h-3 bg-green-400 rounded-full mr-2"></span>
                    Brasil (<span class="font-bold ml-1">45%</span>)
                  </p>
                  <p class="flex items-center text-pink-300">
                    <span class="w-3 h-3 bg-pink-400 rounded-full mr-2"></span>
                    EUA (<span class="font-bold ml-1">25%</span>)
                  </p>
                  <p class="flex items-center text-indigo-300">
                    <span
                      class="w-3 h-3 bg-indigo-500 rounded-full mr-2"
                    ></span>
                    Canadá (<span class="font-bold ml-1">15%</span>)
                  </p>
                  <p class="flex items-center text-yellow-300">
                    <span
                      class="w-3 h-3 bg-yellow-400 rounded-full mr-2"
                    ></span>
                    Outros (<span class="font-bold ml-1">15%</span>)
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div
            class="mt-4 p-4 rounded-lg bg-slate-700/70 border border-slate-600 shadow-lg"
          >
            <h4 class="font-bold text-lg text-white mb-2 flex items-center">
              <i data-lucide="clock-3" class="w-5 h-5 mr-2 text-orange-400"></i>
              Última Aula Registrada
            </h4>
            <div class="text-sm space-y-1">
              <p class="text-slate-300">
                <span class="font-semibold text-indigo-300">Aluno:</span> Ana
                Silva (ID: 1001)
              </p>
              <p class="text-slate-300">
                <span class="font-semibold text-indigo-300">Data/Hora:</span>
                06/11/2025 às 15:00
              </p>
              <div
                class="mt-2 p-2 bg-slate-800 rounded-md border border-slate-600"
              >
                <p class="text-xs font-semibold text-slate-400">
                  Anotação da Aula:
                </p>
                <p class="text-sm text-white">
                  Introdução à estrutura de apresentação em inglês. Foco na
                  pronúncia do 'th'.
                </p>
              </div>
              <a
                href="#"
                class="text-indigo-400 hover:text-indigo-300 text-xs font-medium mt-2 block"
                >Ver histórico completo do aluno →</a
              >
            </div>
          </div>
        </section>

        <section id="coluna-direita" class="w-full md:w-1/5 bg-slate-800 p-4 rounded-lg border border-slate-700 text-white space-y-4">
            <h3 class="text-lg font-bold text-orange-400 border-b border-orange-600 pb-2 flex items-center">
                <i data-lucide="activity" class="w-5 h-5 mr-2"></i> Gestão de Engajamento
            </h3>
            
            <div class="p-1 bg-slate-700/50 rounded-lg border border-slate-600">
                <h4 class="font-bold text-base text-yellow-300 mb-2 p-2 flex items-center">
                    <i data-lucide="trophy" class="w-4 h-4 mr-2"></i> Top Engajamento (10)
                </h4>
                
                <ul class="text-sm space-y-1">
                    <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">1. Ana Silva</span>
                                <span class="student-meta">25 Aulas | Brasil | <span class="level-badge">C2 (Proficiência)</span></span>
                            </div>
                            <span class="rank-badge rank-challenger mt-1">Challenger</span>
                        </div>
                    </a>
                    <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">2. João Melo</span>
                                <span class="student-meta">22 Aulas | EUA | <span class="level-badge">B2 (Interm. Superior)</span></span>
                            </div>
                            <span class="rank-badge rank-grandmaster mt-1">Grandmaster</span>
                        </div>
                    </a>
                    <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">3. Pedro Luiz</span>
                                <span class="student-meta">18 Aulas | Canadá | <span class="level-badge">C1 (Avançado)</span></span>
                            </div>
                            <span class="rank-badge rank-master mt-1">Master</span>
                        </div>
                    </a>
                    <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">4. Maria H.</span>
                                <span class="student-meta">15 Aulas | Japão | <span class="level-badge">A2 (Básico)</span></span>
                            </div>
                            <span class="rank-badge rank-diamond mt-1">Diamond</span>
                        </div>
                    </a>
                     <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">5. Carlos S.</span>
                                <span class="student-meta">14 Aulas | Brasil | <span class="level-badge">B1 (Intermediário)</span></span>
                            </div>
                            <span class="rank-badge rank-emerald mt-1">Emerald</span>
                        </div>
                    </a>
                     <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">6. Fernando G.</span>
                                <span class="student-meta">12 Aulas | Portugal | <span class="level-badge">B2 (Interm. Superior)</span></span>
                            </div>
                            <span class="rank-badge rank-platinum mt-1">Platinum</span>
                        </div>
                    </a>
                     <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">7. Laura V.</span>
                                <span class="student-meta">11 Aulas | Itália | <span class="level-badge">A1 (Iniciante)</span></span>
                            </div>
                            <span class="rank-badge rank-gold mt-1">Gold</span>
                        </div>
                    </a>
                     <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">8. Ricardo L.</span>
                                <span class="student-meta">10 Aulas | Espanha | <span class="level-badge">C1 (Avançado)</span></span>
                            </div>
                            <span class="rank-badge rank-silver mt-1">Silver</span>
                        </div>
                    </a>
                     <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">9. Sofia B.</span>
                                <span class="student-meta">9 Aulas | Argentina | <span class="level-badge">B1 (Intermediário)</span></span>
                            </div>
                            <span class="rank-badge rank-bronze mt-1">Bronze</span>
                        </div>
                    </a>
                     <a href="#" class="list-item-clickable">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-white">10. Thiago A.</span>
                                <span class="student-meta">8 Aulas | Chile | <span class="level-badge">A2 (Básico)</span></span>
                            </div>
                            <span class="rank-badge rank-iron mt-1">Iron</span>
                        </div>
                    </a>
                </ul>
            </div>

            <div class="p-3 bg-slate-700/50 rounded-lg border border-slate-600">
                <h4 class="font-bold text-base text-yellow-400 mb-2 flex items-center">
                    <i data-lucide="alarm-clock" class="w-4 h-4 mr-2"></i> Ausentes (Até 30 dias)
                </h4>
                <ul class="text-sm space-y-2">
                    <a href="#" class="list-item-clickable p-1">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-yellow-400">Aluno A (25 dias)</span>
                                <span class="student-meta">05 Aulas | Portugal | <span class="level-badge">B1 (Intermediário)</span></span>
                            </div>
                            <i data-lucide="mail-plus" class="w-4 h-4 ml-2 text-yellow-400 mt-1"></i>
                        </div>
                    </a>
                </ul>
            </div>
            
             <div class="p-3 bg-slate-700/50 rounded-lg border border-slate-600">
                <h4 class="font-bold text-base text-red-500 mb-2 flex items-center">
                    <i data-lucide="alert-octagon" class="w-4 h-4 mr-2"></i> Risco Crítico (31-60 dias)
                </h4>
                <ul class="text-sm space-y-2">
                    <a href="#" class="list-item-clickable p-1">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-red-500">Aluno C (45 dias)</span>
                                <span class="student-meta">12 Aulas | França | <span class="level-badge">C1 (Avançado)</span></span>
                            </div>
                            <i data-lucide="phone-call" class="w-4 h-4 ml-2 text-red-500 mt-1"></i>
                        </div>
                    </a>
                </ul>
            </div>
            
            <div class="p-3 bg-slate-700/50 rounded-lg border border-slate-600">
                <h4 class="font-bold text-base text-slate-300 mb-2 flex items-center">
                    <i data-lucide="x-octagon" class="w-4 h-4 mr-2"></i> Desistentes (> 60 dias)
                </h4>
                <ul class="text-sm space-y-2">
                     <a href="#" class="list-item-clickable p-1">
                        <div class="flex justify-between items-start">
                            <div class="flex flex-col leading-snug">
                                <span class="truncate font-semibold text-slate-400">Aluno D (65 dias)</span>
                                <span class="student-meta">08 Aulas | Alemanha | <span class="level-badge">B2 (Interm. Superior)</span></span>
                            </div>
                            <i data-lucide="archive" class="w-4 h-4 ml-2 text-slate-400 mt-1"></i>
                        </div>
                    </a>
                </ul>
            </div>
        </section>
      </div>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        lucide.createIcons();
      });
      const DEFAULT_DOLLAR_RATE = 5.0;
      const PLATFORM_FEE_RATE = 0.015;
      const AUTO_UPDATE_MS = 30 * 60 * 1000;
      const API_PRIMARY =
        "https://api.exchangerate.host/latest?base=USD&symbols=BRL";
      const API_FALLBACK = "https://api.frankfurter.app/latest?from=USD&to=BRL";

      let currentDollarRate = DEFAULT_DOLLAR_RATE;
      const cotacaoElement = document.getElementById("cotacao-dolar");
      const descontoUsdEl = document.getElementById("desconto-usd");
      const brutoUsdEl = document.getElementById("total-bruto-usd");
      const liquidoBrlEl = document.getElementById("total-liquido-brl");
      const btnRefresh = document.getElementById("btn-refresh");
      const iconRefresh = document.getElementById("icon-refresh");

      function formatBRL(value) {
        return value.toLocaleString("pt-BR", {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2,
        });
      }
      function formatUSD(value) {
        return value.toFixed(2).replace(".", ",");
      }

      function calculateMetrics(totalBrutoAntesTaxa = 10.0) {
        const descontoUSD = totalBrutoAntesTaxa * PLATFORM_FEE_RATE;
        const totalLiquidoUSD = totalBrutoAntesTaxa - descontoUSD;
        const totalLiquidoBRL = totalLiquidoUSD * currentDollarRate;

        descontoUsdEl.textContent = `US$ ${formatUSD(descontoUSD)}`;
        brutoUsdEl.textContent = `US$ ${formatUSD(totalLiquidoUSD)}`;
        liquidoBrlEl.textContent = `R$ ${formatBRL(totalLiquidoBRL)}`;
      }

      async function fetchJson(url) {
        const resp = await fetch(url, { cache: "no-store" });
        if (!resp.ok) throw new Error("Erro HTTP: " + resp.status);
        return resp.json();
      }

      async function getDollarRate() {
        try {
          const data = await fetchJson(API_PRIMARY);
          if (data?.rates?.BRL) return data.rates.BRL;
          throw new Error("Formato inesperado (primária)");
        } catch {
          const data2 = await fetchJson(API_FALLBACK);
          if (data2?.rates?.BRL) return data2.rates.BRL;
          throw new Error("Formato inesperado (fallback)");
        }
      }

      async function updateDollarRate(showSpinner = false) {
        if (showSpinner) iconRefresh.classList.add("spinning");
        try {
          const rate = await getDollarRate();
          currentDollarRate = Math.round(rate * 100) / 100;
          cotacaoElement.textContent = `R$ ${formatBRL(currentDollarRate)}`;
          cotacaoElement.classList.remove("text-red-400", "text-yellow-400");
          cotacaoElement.classList.add("text-green-300");
          calculateMetrics();
        } catch (err) {
          console.error("Erro ao buscar cotação:", err);
          cotacaoElement.textContent = `R$ ${formatBRL(
            currentDollarRate
          )} (erro)`;
          cotacaoElement.classList.remove("text-green-300", "text-yellow-400");
          cotacaoElement.classList.add("text-red-400");
        } finally {
          if (showSpinner) iconRefresh.classList.remove("spinning");
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        // Esta chamada de lucide.createIcons() foi movida para o início do script
        lucide.createIcons();
        calculateMetrics();
        updateDollarRate(false);
        setInterval(() => updateDollarRate(false), AUTO_UPDATE_MS);
        btnRefresh.addEventListener("click", () => updateDollarRate(true));
      });
      // O código de carregamento dinâmico foi removido, pois o conteúdo já está aqui.
    </script>
  </body>
</html>